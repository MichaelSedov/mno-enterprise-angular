<div class="dashboard-marketplace-compare">
  <mno-loader ng-show="vm.isLoading" class="top-buffer-4"></mno-loader>
  <!-- Header -->
  <div class="row show-header top-buffer-4">
    <div class="col-md-12">
      <a ui-sref="home.marketplace()" class="text-muted">
        <i class="fa fa-chevron-left"></i> {{ 'mno_enterprise.templates.dashboard.marketplace.show.back' | translate }}
      </a>
    </div>
  </div>
  <div class="marketplace-compare-wrap" ng-show="!vm.isLoading">
    <div class="row">
      <div class="col-md-12">
        <h1>Comparison</h1>
        <div class="marketplace-compare-info">
          <table class="marketplace-compare-table table table-bordered">
            <tr>
              <th></th>
              <td ng-repeat="app in vm.apps | filter:{is_compare: true } | limitTo:4"><a ui-sref="home.marketplace.app({appId: app.id})"><img class="media-object" ng-src="{{app.logo}}" ng-alt="{{app.name}}"></a></td>
            </tr>
            <tr>
              <th>Application Provider</th>
              <td ng-repeat="app in vm.apps | filter:{is_compare: true } | limitTo:4">{{app.name}}</td>
            </tr>
            <tr>
              <th>Category</th>
              <td ng-repeat="app in vm.apps | filter:{is_compare: true } | limitTo:4">{{app.categories[2]}}</td>
            </tr>
            <tr>
              <th>Key benefits</th>
              <td ng-repeat="app in vm.apps | filter:{is_compare: true } | limitTo:4">
                <ul>
                  <li ng-repeat="benefit in app.key_benefits track by $index">
                    {{benefit}}
                  </li>
                </ul>
              </td>
            </tr>
            <tr>
              <th>Short description</th>
              <td ng-repeat="app in vm.apps | filter:{is_compare: true } | limitTo:4">{{app.tiny_description}}</td>
            </tr>
            <tr>
              <th>Rating</th>
              <td ng-repeat="app in vm.apps | filter:{is_compare: true } | limitTo:4">{{app.average_rating}}</td>
            </tr>
            <tr>
              <th>Number of agencies using the application</th>
              <td ng-repeat="app in vm.apps | filter:{is_compare: true } | limitTo:4">{{app.running_instances_count}}</td>
            </tr>
            <tr ng-if="!vm.isPriceShown">
              <th>Pricing</th>
              <td ng-repeat="app in vm.apps | filter:{is_compare: true } | limitTo:4">
                <ul>
                  <li ng-repeat="plan in app.pricing_plans[vm.pricing_plans]">
                    <b>{{plan.name}}</b><br>
                    <span ng-if="plan.price.value">{{plan.currency}} {{plan.price.value}} {{plan.factor}}</span>
                    <span ng-if="!plan.price.value">pricing information not available</span>
                  </li>
                </ul>
              </td>
            </tr>
            <tr class="text-center">
              <th></th>
              <td ng-repeat="app in vm.apps | filter:{is_compare: true } | limitTo:4">
                <div ng-switch on="vm.appInstallationStatus()">
                    <div ng-switch-when="CONFLICT" class="message">
                      <i class="fa fa-exclamation-triangle"></i>
                      {{ 'mno_enterprise.templates.dashboard.marketplace.show.conflicting_app' | translate }}
                      <a ui-sref="home.marketplace.app({appId: vm.conflictingApp.id})">{{vm.conflictingApp.name}}</a>
                    </div>
                    <button ng-switch-when="INSTALLABLE" ng-click="vm.provisionApp()" ng-disabled="vm.isLoadingButton" class="btn btn-warning btn-lg">
                      <span ng-show="vm.isLoadingButton"><i class="fa fa-spinner fa-pulse"></i>&nbsp;</span>
                      {{ 'mno_enterprise.templates.dashboard.marketplace.show.start_app' | translate }}
                    </button>
                    <button ng-switch-when="INSTALLED_LAUNCH" ng-click="vm.launchAppInstance()" class="btn btn-warning btn-lg">
                      {{ 'mno_enterprise.templates.dashboard.marketplace.show.launch_app' | translate }}
                    </button>
                    <button ng-switch-when="INSTALLED_CONNECT" ng-click="vm.connectAppInstance()" class="btn btn-warning btn-lg">
                      {{ 'mno_enterprise.templates.dashboard.marketplace.show.connect_app' | translate }}
                    </button>
                </div>
              </td>
            </tr>

          </table>
        </div>
      </div>
    </div>
  </div>
</div>
